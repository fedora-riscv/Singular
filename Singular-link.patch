--- singular-4.2.0/configure.ac.orig	2021-04-14 06:26:53.000000000 -0600
+++ singular-4.2.0/configure.ac	2021-05-25 19:48:16.657430623 -0600
@@ -341,4 +341,10 @@ AC_ARG_ENABLE([doc-build],
 ])
 AM_CONDITIONAL([ENABLE_DOC_BUILD], [test "$enable_doc_build" = yes])
 
+AC_CONFIG_COMMANDS([norpath], [
+sed -e 's|^hardcode_libdir_flag_spec=.*|hardcode_libdir_flag_spec=""|g' \
+    -e 's|^runpath_var=LD_RUN_PATH|runpath_var=DIE_RPATH_DIE|g' \
+    -e 's|CC="\(g.*\)"|CC="\1 -Wl,--as-needed"|' \
+    -i libtool
+])
 AC_OUTPUT
--- singular-4.2.0/factory/configure.ac.orig	2021-04-14 09:52:55.000000000 -0600
+++ singular-4.2.0/factory/configure.ac	2021-05-25 19:48:16.658430620 -0600
@@ -412,5 +412,11 @@ AC_DEFINE_UNQUOTED([FACTORYCONFIGURATION
 
 
 AC_CONFIG_FILES([Makefile include/factory/Makefile factory.pc]) #  ftest/GNUmakefile
+AC_CONFIG_COMMANDS([norpath], [
+sed -e 's|^hardcode_libdir_flag_spec=.*|hardcode_libdir_flag_spec=""|g' \
+    -e 's|^runpath_var=LD_RUN_PATH|runpath_var=DIE_RPATH_DIE|g' \
+    -e 's|CC="\(g.*\)"|CC="\1 -Wl,--as-needed"|' \
+    -i libtool
+])
 AC_OUTPUT
 
--- singular-4.2.0/gfanlib/configure.ac.orig	2021-04-14 09:52:55.000000000 -0600
+++ singular-4.2.0/gfanlib/configure.ac	2021-05-25 19:48:16.659430617 -0600
@@ -48,4 +48,10 @@ AC_LANG_POP()
 
 AC_CONFIG_FILES([Makefile])
 ## AC_CONFIG_HEADERS([config.h])
+AC_CONFIG_COMMANDS([norpath], [
+sed -e 's|^hardcode_libdir_flag_spec=.*|hardcode_libdir_flag_spec=""|g' \
+    -e 's|^runpath_var=LD_RUN_PATH|runpath_var=DIE_RPATH_DIE|g' \
+    -e 's|CC="\(g.*\)"|CC="\1 -Wl,--as-needed"|' \
+    -i libtool
+])
 AC_OUTPUT
--- singular-4.2.0/libpolys/configure.ac.orig	2021-05-25 19:48:16.660430614 -0600
+++ singular-4.2.0/libpolys/configure.ac	2021-05-25 19:51:10.892924374 -0600
@@ -162,4 +162,10 @@ AC_CONFIG_FILES([polys/Makefile])
 AC_CONFIG_FILES([tests/Makefile])
 AC_CONFIG_FILES([libpolys-config], [chmod +x libpolys-config])
 AC_CONFIG_FILES([libpolys.pc])
+AC_CONFIG_COMMANDS([norpath], [
+sed -e 's|^hardcode_libdir_flag_spec=.*|hardcode_libdir_flag_spec=""|g' \
+    -e 's|^runpath_var=LD_RUN_PATH|runpath_var=DIE_RPATH_DIE|g' \
+    -e 's|CC="\(g.*\)"|CC="\1 -Wl,--as-needed"|' \
+    -i libtool
+])
 AC_OUTPUT
--- singular-4.2.0/omalloc/configure.ac.orig	2021-04-14 09:52:55.000000000 -0600
+++ singular-4.2.0/omalloc/configure.ac	2021-05-25 19:48:16.661430611 -0600
@@ -607,5 +607,11 @@ dnl llllllllllllllllllllllllllllllllllll
 dnl wrap it up
 dnl
 AC_CONFIG_FILES([Makefile omalloc.pc])
+AC_CONFIG_COMMANDS([norpath], [
+sed -e 's|^hardcode_libdir_flag_spec=.*|hardcode_libdir_flag_spec=""|g' \
+    -e 's|^runpath_var=LD_RUN_PATH|runpath_var=DIE_RPATH_DIE|g' \
+    -e 's|CC="\(g.*\)"|CC="\1 -Wl,--as-needed"|' \
+    -i libtool
+])
 AC_OUTPUT
 
--- singular-4.2.0/resources/configure.ac.orig	2021-04-14 09:52:55.000000000 -0600
+++ singular-4.2.0/resources/configure.ac	2021-05-25 19:48:16.661430611 -0600
@@ -73,4 +73,10 @@ AX_NORMALIZE_PATH([config_datadir],['/']
 AC_DEFINE_UNQUOTED([DATA_DIR],"$config_datadir",[datadir])
 
 AC_CONFIG_FILES([singular_resources.pc Makefile])
+AC_CONFIG_COMMANDS([norpath], [
+sed -e 's|^hardcode_libdir_flag_spec=.*|hardcode_libdir_flag_spec=""|g' \
+    -e 's|^runpath_var=LD_RUN_PATH|runpath_var=DIE_RPATH_DIE|g' \
+    -e 's|CC="\(g.*\)"|CC="\1 -Wl,--as-needed"|' \
+    -i libtool
+])
 AC_OUTPUT
